{% extends 'base.html' %}
{% load static %}
{% block title %}Edit Request | Maxim Cypher{% endblock %}

{% block nav_image %}{% endblock %}

{% block content %}
<div class="premium-container edit-request-wrapper">
  <h2 class="edit-request-heading">Edit Your Request</h2>

  {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" class="edit-request-form">
    {% csrf_token %}
    <label for="title">Title</label>
    <input type="text" id="title" name="title" value="{{ request_obj.title }}" required>

    <label for="description">Description</label>
    <textarea id="description" name="description" required>{{ request_obj.description }}</textarea>

    <label for="category">Category</label>
    <select name="category" id="category" required>
      {% for key, label in request_obj.CATEGORY_CHOICES %}
        <option value="{{ key }}" {% if request_obj.category == key %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>

    <label for="priority">Priority</label>
    <select name="priority" id="priority" required>
      {% for key, label in request_obj.PRIORITY_CHOICES %}
        <option value="{{ key }}" {% if request_obj.priority == key %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>

    <button type="submit" class="edit-request-btn-submit">Save Changes</button>
  </form>

  <form method="post" action="{% url 'delete_request' request_obj.id %}" onsubmit="return confirm('Are you sure you want to delete this request?');">
    {% csrf_token %}
    <button type="submit" class="edit-request-btn-delete">Delete This Request</button>
  </form>

  <h3>Your Other Requests</h3>
  <ul class="edit-request-list">
    {% for req in requests %}
      <li>
        <strong>{{ req.title }}</strong> — {{ req.description }}
        {% if req.id != request_obj.id %}
          <a href="{% url 'edit_request' req.id %}" class="edit-request-btn-small">Edit</a>
        {% endif %}
      </li>
    {% empty %}
      <li>No other requests yet.</li>
    {% endfor %}
  </ul>

  <a href="{% url 'premium_dashboard' %}" class="edit-request-btn-back">← Back to Dashboard</a>
</div>
{% endblock %}
